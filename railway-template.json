{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "AutoMem - Persistent AI Memory",
  "description": "Graph + Vector memory system for AI agents with persistent storage and automatic backups",
  "repository": "https://github.com/verygoodplugins/automem",
  "variables": {
    "FALKORDB_PASSWORD": {
      "description": "Password for FalkorDB (auto-generated)",
      "generator": "secret"
    },
    "AUTOMEM_API_TOKEN": {
      "description": "API token for memory operations (auto-generated)",
      "generator": "secret"
    },
    "ADMIN_API_TOKEN": {
      "description": "Admin API token for maintenance operations (auto-generated)",
      "generator": "secret"
    }
  },
  "services": [
    {
      "name": "memory-service",
      "source": {
        "repo": "https://github.com/verygoodplugins/automem",
        "branch": "main"
      },
      "builder": "DOCKERFILE",
      "healthcheck": {
        "path": "/health",
        "timeout": 100
      },
      "env": {
        "PORT": "8001",
        "FALKORDB_HOST": "${{falkordb.RAILWAY_PRIVATE_DOMAIN}}",
        "FALKORDB_PORT": "6379",
        "FALKORDB_PASSWORD": "${{shared.FALKORDB_PASSWORD}}",
        "FALKORDB_GRAPH": "memories",
        "AUTOMEM_API_TOKEN": "${{shared.AUTOMEM_API_TOKEN}}",
        "ADMIN_API_TOKEN": "${{shared.ADMIN_API_TOKEN}}",
        "OPENAI_API_KEY": "",
        "QDRANT_URL": "",
        "QDRANT_API_KEY": ""
      }
    },
    {
      "name": "automem-mcp-sse",
      "source": {
        "repo": "https://github.com/verygoodplugins/automem",
        "branch": "main"
      },
      "builder": "NIXPACKS",
      "buildCommand": "cd mcp-sse-server && npm i",
      "startCommand": "node mcp-sse-server/server.js",
      "healthcheck": {
        "path": "/health",
        "timeout": 100
      },
      "env": {
        "PORT": "8080",
        "AUTOMEM_ENDPOINT": "http://${{memory-service.RAILWAY_PRIVATE_DOMAIN}}:8001",
        "AUTOMEM_API_TOKEN": "${{shared.AUTOMEM_API_TOKEN}}"
      }
    },
    {
      "name": "falkordb",
      "image": "falkordb/falkordb:latest",
      "volumes": [
        {
          "mountPath": "/var/lib/falkordb/data",
          "name": "falkordb_data"
        }
      ],
      "env": {
        "PORT": "6379",
        "FALKOR_PASSWORD": "${{shared.FALKORDB_PASSWORD}}",
        "FALKOR_USERNAME": "default",
        "FALKOR_HOST": "${{RAILWAY_PRIVATE_DOMAIN}}",
        "FALKOR_PORT": "${{PORT}}",
        "FALKOR_PUBLIC_HOST": "${{RAILWAY_TCP_PROXY_DOMAIN}}",
        "FALKOR_PUBLIC_PORT": "${{RAILWAY_TCP_PROXY_PORT}}",
        "REDIS_ARGS": "--save 60 1 --appendonly yes --appendfsync everysec"
      }
    }
  ],
  "databases": [],
  "plugins": []
}
